function createHeader(movieDetails){let header=createElementWithClass("div","modal-header"),image=document.createElement("img");image.src=movieDetails.image_url,image.setAttribute("class","modal-image"),header.appendChild(image);let title_div=createElementWithClass("div","modal-title");return title_div.innerHTML=movieDetails.title,header.appendChild(title_div),header}function createDate(date_published){let date=date_published;date=date.slice(8,10)+"/"+date.slice(5,7)+"/"+date.slice(0,4);let dateDiv=createElementWithClass("span","modal-globaldetails");return dateDiv.innerHTML=date,dateDiv}function createAgeRating(rated){if("Not rated or unkown rating"===rated?rated="":rated+="+",""!=rated){let ratedDiv=createElementWithClass("span","modal-globaldetails");return ratedDiv.innerHTML=rated,ratedDiv}return null}function createDuration(duration){duration<60?duration+="min":duration=Math.floor(duration/60)+"h"+(duration-60*Math.floor(duration/60))+"min";let durationDiv=createElementWithClass("span","modal-globaldetails");return durationDiv.innerHTML=duration,durationDiv}function createCriticsRating(rating){let starsDiv=createElementWithClass("span","modal-globaldetails");return starsDiv.innerHTML=getRatingStars(rating),starsDiv}function createBoxOffice(income){if(income?income>=1e9?income=(income/1e9).toPrecision(3)+"Md$":income>=1e6?income=(income/1e6).toPrecision(3)+"Mn$":income>=1e3?income=(income/1e3).toPrecision(3)+"k$":income+=" $":income="",""!=income){let boxOfficeDiv=createElementWithClass("span","modal-globaldetails");return boxOfficeDiv.innerHTML=income,boxOfficeDiv}return null}function createGlobalDetails(movieDetails){let globalDetails=createElementWithClass("div","modal-global");return globalDetails.appendChild(createDate(movieDetails.date_published)),ageRating=createAgeRating(movieDetails.rated),ageRating&&globalDetails.appendChild(ageRating),globalDetails.appendChild(createDuration(movieDetails.duration)),globalDetails.appendChild(createCriticsRating(movieDetails.imdb_score)),boxOffice=movieDetails.worldwide_gross_income,boxOffice&&globalDetails.appendChild(createBoxOffice(movieDetails.worldwide_gross_income)),globalDetails}function createDescription(description){let descriptionDiv=createElementWithClass("div","modal-summary");return descriptionDiv.innerHTML="<hr>"+description+"<hr>",descriptionDiv}function createAdditionalDetails(movieDetails){let additionalDetails=[],origin=createElementWithClass("div","modal-origin");origin.innerHTML="<b>Origine:</b> "+movieDetails.countries.join(", "),additionalDetails.push(origin);let genre=createElementWithClass("div","modal-genre");genreList=movieDetails.genres,genreList.length<2?genre.innerHTML="<b>Genre:</b> "+movieDetails.genres:genre.innerHTML="<b>Genres:</b> "+movieDetails.genres.join(", "),additionalDetails.push(genre);let director=createElementWithClass("div","modal-director");director.innerHTML="<b>RÃ©alisateur:</b> "+movieDetails.directors,additionalDetails.push(director);let actors=createElementWithClass("div","modal-actors");return actors.innerHTML="<b>Acteurs:</b> "+movieDetails.actors.join(", "),additionalDetails.push(actors),additionalDetails}function populateModal(movieDetails){let modal=document.getElementsByClassName("modal-wrapper")[0],elements=[];elements.push(createHeader(movieDetails)),elements.push(createGlobalDetails(movieDetails)),elements.push(createDescription(movieDetails.description)),elements.push(...createAdditionalDetails(movieDetails));for(var i=0;i<elements.length;i++)modal.appendChild(elements[i])}const openModal=async function(id){modal=await loadModal(id),loader=document.getElementById("loader-Modal"),loader.style.display="block";const movieDetails=await queryMovieDetails(id);populateModal(movieDetails),loader.style.display="none",modal.style.display=null,modal.removeAttribute("aria-hidden"),modal.setAttribute("aria-modal","true"),modal.addEventListener("click",closeModal),modal.querySelector(".modal-close").addEventListener("click",closeModal)},closeModal=function(e){if(null===modal)return;modal.querySelector(".modal-wrapper").innerHTML='<div class="loader" id="loader-Modal" style="display: none">',e.preventDefault(),modal.setAttribute("aria-hidden","true"),modal.removeAttribute("aria-modal"),modal.removeEventListener("click",closeModal),modal.querySelector(".modal-close").removeEventListener("click",closeModal);const hideModal=function(){modal.style.display="none",modal.removeEventListener("animationend",hideModal),modal=null};modal.addEventListener("animationend",hideModal)},loadModal=async function(){const target="#modal",exitingModal=document.querySelector(target);if(null!==exitingModal)return exitingModal;const html=await fetch("src/modal.html#modal").then(response=>response.text()),element=document.createRange().createContextualFragment(html).querySelector(target);return document.body.append(element),element};function addModal(item){item.addEventListener("click",(function(){openModal(item.id)}))}